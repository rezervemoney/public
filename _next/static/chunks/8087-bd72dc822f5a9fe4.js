"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8087],{18595:(e,s,r)=>{r.d(s,{r:()=>m});var a=r(12115),t=r(2145),n=r(9428),l=r(2962),i=r(97351),o=r(75162),c=r(67474),d=r(99190);function m(){let{address:e}=(0,t.F)(),[s,r]=(0,a.useState)(null),[m,u]=(0,a.useState)(!1),[x,g]=(0,a.useState)(null),[f,p]=(0,a.useState)(null),h=(0,a.useCallback)(async(s,a)=>{if(e)try{let t=await (0,n.J)(c.$,{address:s,abi:d,functionName:"allowance",args:[e,a]});r(t)}catch(e){console.error("Error fetching allowance:",e),r(null)}},[e]),b=(0,a.useCallback)(async(s,r,a)=>{if(!e){g("Wallet not connected");return}u(!0),g(null),p(null);try{let{request:e}=await (0,l.v)(c.$,{address:s,abi:d,functionName:"approve",args:[r,a]}),t=await (0,i.E)(c.$,e);p(t),await (0,o.n)(c.$,{hash:t}),await h(s,r)}catch(e){console.error("Approval failed:",e),g(e instanceof Error?e.message:"Approval failed")}finally{u(!1)}},[e,h]);return{allowance:s,isApproving:m,approveError:x,approveTxHash:f,fetchAllowance:h,approve:b}}},67667:(e,s,r)=>{r.d(s,{t:()=>o});var a=r(34540),t=r(76736),n=r(2145),l=r(13558),i=r(81100);function o(){let{tokenInfos:e,bondPositions:s,loading:r,error:o,lastUpdated:c}=(0,a.d4)(e=>e.balances),{address:d}=(0,n.F)(),{data:m,isLoading:u}=(0,l.A)({address:d,chainId:i.T.id,token:t.A.tokens.SONIC.address}),x=s=>{let r=e.find(e=>e.symbol===s);return(null==r?void 0:r.allowance)||0n};return{tokenInfos:e,bondPositions:s,nativeBalance:m?m.formatted:"0",isNativeBalanceLoading:u,userAddress:d,loading:r,error:o,lastUpdated:c,getFormattedBalance:s=>{let r=t.A.tokens[s],a=e.find(e=>e.symbol===s);return(Number((null==a?void 0:a.balance)||0n)/Math.pow(10,r.decimals)).toFixed(r.decimals)},getContractBalance:s=>{let r=t.A.tokens[s],a=e.find(e=>e.symbol===s);return(Number((null==a?void 0:a.balance)||0n)/Math.pow(10,r.decimals)).toFixed(r.decimals)},getApproval:x,getFormattedApproval:e=>{let s=t.A.tokens[e];return(Number(x(e))/Math.pow(10,s.decimals)).toFixed(s.decimals)}}}},85894:(e,s,r)=>{r.d(s,{S:()=>F});var a=r(95155),t=r(12115),n=r(40646),l=r(51154),i=r(99840),o=r(97168),c=r(41397),d=r(49026),m=r(2145),u=r(6874),x=r.n(u),g=r(65521),f=r(97868),p=r(61046),h=r(76736),b=r(36768),N=r(86770),y=r(81100),j=r(97351),v=r(75162),w=r(67474);let A=(0,g.v)(e=>({isMinting:!1,mintError:null,mintTxHash:null,zapAndMint:async(s,r,a)=>{e({isMinting:!0,mintError:null,mintTxHash:null});try{let t={chainId:y.T.id,inputTokens:[{tokenAddress:a,amount:(0,f.g)(s).toString()}],outputTokens:[{tokenAddress:h.A.tokens.scUSD.address,proportion:1}],userAddr:h.A.coreAddresses.uiHelperWrite},n=await (0,N.S)(t);if(!n)throw Error("invalid quote from odos");let l=await (0,N.p)(h.A.coreAddresses.uiHelperWrite,n);if(console.log("\uD83D\uDE80 ~ zapAndMint: ~ odosData:",l),!l)throw Error("invalid tx data from odos");console.log("\uD83D\uDE80 ~ zapAndMint: ~ odosData:",r,(0,f.g)(s).toString(),a,l.transaction.data);let i=await (0,j.E)(w.$,{address:h.A.coreAddresses.uiHelperWrite,abi:b,functionName:"zapAndMint",args:[r,(0,f.g)(s),a,l.transaction.data],value:a===p.Xd?(0,f.g)(s):0n}),o=await (0,v.n)(w.$,{hash:i});console.log("\uD83D\uDE80 ~ zapAndMint: ~ receipt:",o),e({mintTxHash:i})}catch(s){console.error("Mint failed:",s),e({mintError:"Mint failed. Please try again."})}finally{e({isMinting:!1})}}}));var k=r(53999),C=r(18595),M=r(89090),E=r(88579);function F(e){let{isOpen:s,onClose:r,mintData:u}=e,[g,f]=(0,t.useState)("confirm"),{address:p}=(0,m.F)(),{isMinting:b,mintError:N,mintTxHash:y,zapAndMint:j}=A(),{allowance:v,isApproving:w,approveError:F,approveTxHash:S,fetchAllowance:T,approve:R}=(0,C.r)();if(!u)return null;let $=Number.parseFloat(u.amount||"0"),H=Number.parseFloat(u.dreAmount||"0"),W=(0,M.X)(u.amount,18);(0,t.useEffect)(()=>{s&&p&&"0x0000000000000000000000000000000000000000"!==u.tokenAddress&&T(u.tokenAddress,h.A.coreAddresses.uiHelperWrite)},[s,p,T]);let z=async()=>{if(!p){f("error");return}"0x0000000000000000000000000000000000000000"===u.tokenAddress?await Z():!v||v<W?await I():await Z()},I=async()=>{f("approve"),await R(u.tokenAddress,h.A.coreAddresses.uiHelperWrite,E.Ao.toString()),F?f("error"):S&&(f("mint"),await Z())},Z=async()=>{if(!p){f("error");return}f("mint"),await j(u.amount,p,u.tokenAddress),N?f("error"):y&&f("success")},_=()=>{f("confirm"),r()},O=()=>{switch(g){case"confirm":case"error":default:return 0;case"approve":return 25;case"mint":return 50;case"success":return 100}};return(0,a.jsx)(i.lG,{open:s,onOpenChange:_,children:(0,a.jsxs)(i.Cf,{className:"sm:max-w-md bg-gray-100 border-gray-700",children:[(0,a.jsxs)(i.c7,{children:[(0,a.jsx)(i.L3,{className:"flex items-center gap-2 text-gray-700",children:"Mint RZR"}),(0,a.jsx)(i.rr,{className:"text-gray-400",children:"Automatically convert your assets into RZR"})]}),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Transaction Progress"}),(0,a.jsxs)("span",{className:"text-gold-400",children:[O(),"%"]})]}),(0,a.jsx)(c.k,{value:O(),className:"h-2 bg-gray-300",indicatorClassName:"bg-gradient-to-r from-gold-500 to-gold-600"})]}),(0,a.jsxs)("div",{className:"rounded-md bg-white border border-gray-300 p-4 space-y-3",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-sm text-gray-400",children:"Your Assets"}),(0,a.jsxs)("span",{className:"text-sm font-mono text-gray-700",children:[(0,k.ej)($)," ",(e=>{let s=Object.entries(h.A.tokens).find(s=>{let[r,a]=s;return a.address===e});return s?s[1].symbol:"SONIC"})(u.tokenAddress)]})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-sm text-gray-400",children:"RZR to Receive"}),(0,a.jsxs)("span",{className:"text-sm font-mono text-gold-400",children:[(0,k.ej)(H)," RZR"]})]})]}),"success"===g&&(0,a.jsxs)(d.Fc,{className:"bg-green-500/10 border-green-500/30",children:[(0,a.jsx)(n.A,{className:"h-4 w-4 text-green-400"}),(0,a.jsxs)(d.TN,{className:"text-gray-300",children:[(0,a.jsx)("strong",{children:"Success!"})," ",(0,k.ej)(H)," RZR minted.",(0,a.jsx)("div",{className:"mt-2 space-y-1",children:(0,a.jsx)("div",{className:"text-xs font-mono text-green-400",children:(0,a.jsx)(x(),{href:"https://sonicscan.org/tx/".concat(y),target:"_blank",className:"text-green-400",children:"View Transaction on Explorer"})})})]})]}),"error"===g&&(0,a.jsx)(d.Fc,{className:"bg-red-500/10 border-red-500/30",children:(0,a.jsxs)(d.TN,{className:"text-gray-800",children:[(0,a.jsx)("strong",{children:"Error:"})," ",N||F||"Transaction failed"]})}),(0,a.jsxs)("div",{className:"space-y-3",children:["confirm"===g&&(0,a.jsx)("div",{className:"space-y-4",children:(0,a.jsxs)("div",{className:"flex gap-3",children:[(0,a.jsx)(o.$,{variant:"outline",className:"flex-1 text-gray-600 border-gray-500",onClick:_,children:"Cancel"}),(0,a.jsx)(o.$,{className:"flex-1 bg-gradient-to-r from-blue-primary text-white to-yellow-primary",onClick:z,children:"Mint"})]})}),"approve"===g&&(0,a.jsx)("div",{className:"space-y-4",children:(0,a.jsx)(o.$,{className:"w-full bg-gradient-to-r text-white",disabled:w,onClick:I,children:w?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(l.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Approving..."]}):"Approve"})}),"mint"===g&&(0,a.jsx)("div",{className:"space-y-4",children:(0,a.jsx)(o.$,{className:"w-full bg-gradient-to-r from-gold-500 to-gold-600 hover:from-gold-600 hover:to-gold-700 text-white",disabled:b,onClick:Z,children:b?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(l.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Minting..."]}):"Execute Mint"})}),"success"===g&&(0,a.jsx)("div",{className:"space-y-4",children:(0,a.jsx)(o.$,{className:"w-full bg-gradient-to-r from-gold-500 to-gold-600 hover:from-gold-600 hover:to-gold-700 text-black",onClick:_,children:"Close"})}),"error"===g&&(0,a.jsx)("div",{className:"space-y-4",children:(0,a.jsx)(o.$,{variant:"outline",className:"w-full text-gray-600",onClick:()=>f("confirm"),children:"Try Again"})})]})]})]})})}},89852:(e,s,r)=>{r.d(s,{p:()=>l});var a=r(95155),t=r(12115),n=r(53999);let l=t.forwardRef((e,s)=>{let{className:r,type:t,...l}=e;return(0,a.jsx)("input",{type:t,className:(0,n.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",r),ref:s,...l})});l.displayName="Input"}}]);