"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8087],{18595:(e,s,a)=>{a.d(s,{r:()=>m});var r=a(12115),t=a(2145),n=a(9428),l=a(2962),i=a(97351),o=a(75162),c=a(67474),d=a(99190);function m(){let{address:e}=(0,t.F)(),[s,a]=(0,r.useState)(null),[m,u]=(0,r.useState)(!1),[x,g]=(0,r.useState)(null),[f,p]=(0,r.useState)(null),h=(0,r.useCallback)(async(s,r)=>{if(e)try{let t=await (0,n.J)(c.$,{address:s,abi:d,functionName:"allowance",args:[e,r]});a(t)}catch(e){console.error("Error fetching allowance:",e),a(null)}},[e]),b=(0,r.useCallback)(async(s,a,r)=>{if(!e){g("Wallet not connected");return}u(!0),g(null),p(null);try{let{request:e}=await (0,l.v)(c.$,{address:s,abi:d,functionName:"approve",args:[a,r]}),t=await (0,i.E)(c.$,e);p(t),await (0,o.n)(c.$,{hash:t}),await h(s,a)}catch(e){console.error("Approval failed:",e),g(e instanceof Error?e.message:"Approval failed")}finally{u(!1)}},[e,h]);return{allowance:s,isApproving:m,approveError:x,approveTxHash:f,fetchAllowance:h,approve:b}}},67667:(e,s,a)=>{a.d(s,{t:()=>o});var r=a(34540),t=a(76736),n=a(2145),l=a(13558),i=a(81100);function o(){let{tokenInfos:e,bondPositions:s,loading:a,error:o,lastUpdated:c}=(0,r.d4)(e=>e.balances),{address:d}=(0,n.F)(),{data:m,isLoading:u}=(0,l.A)({address:d,chainId:i.T.id,token:t.A.tokens.SONIC.address}),x=s=>{let a=e.find(e=>e.symbol===s);return(null==a?void 0:a.allowance)||0n};return{tokenInfos:e,bondPositions:s,nativeBalance:m?m.formatted:"0",isNativeBalanceLoading:u,userAddress:d,loading:a,error:o,lastUpdated:c,getFormattedBalance:s=>{let a=t.A.tokens[s],r=e.find(e=>e.symbol===s);return(Number((null==r?void 0:r.balance)||0n)/Math.pow(10,a.decimals)).toFixed(a.decimals)},getContractBalance:s=>{let a=t.A.tokens[s],r=e.find(e=>e.symbol===s);return(Number((null==r?void 0:r.balance)||0n)/Math.pow(10,a.decimals)).toFixed(a.decimals)},getApproval:x,getFormattedApproval:e=>{let s=t.A.tokens[e];return(Number(x(e))/Math.pow(10,s.decimals)).toFixed(s.decimals)}}}},85894:(e,s,a)=>{a.d(s,{S:()=>F});var r=a(95155),t=a(12115),n=a(40646),l=a(51154),i=a(99840),o=a(97168),c=a(41397),d=a(49026),m=a(2145),u=a(6874),x=a.n(u),g=a(65521),f=a(97868),p=a(61046),h=a(76736),b=a(49433),N=a(86770),y=a(81100),j=a(97351),v=a(75162),w=a(67474);let A=(0,g.v)(e=>({isMinting:!1,mintError:null,mintTxHash:null,zapAndMint:async(s,a,r)=>{e({isMinting:!0,mintError:null,mintTxHash:null});try{let t={chainId:y.T.id,inputTokens:[{tokenAddress:r,amount:(0,f.g)(s).toString()}],outputTokens:[{tokenAddress:h.A.tokens.scUSD.address,proportion:1}],userAddr:h.A.coreAddresses.uiHelper},n=await (0,N.S)(t);if(!n)throw Error("invalid quote from odos");let l=await (0,N.p)(h.A.coreAddresses.uiHelper,n);if(console.log("\uD83D\uDE80 ~ zapAndMint: ~ odosData:",l),!l)throw Error("invalid tx data from odos");console.log("\uD83D\uDE80 ~ zapAndMint: ~ odosData:",a,(0,f.g)(s).toString(),r,l.transaction.data);let i=await (0,j.E)(w.$,{address:h.A.coreAddresses.uiHelper,abi:b,functionName:"zapAndMint",args:[a,(0,f.g)(s),r,l.transaction.data],value:r===p.Xd?(0,f.g)(s):0n}),o=await (0,v.n)(w.$,{hash:i});console.log("\uD83D\uDE80 ~ zapAndMint: ~ receipt:",o),e({mintTxHash:i})}catch(s){console.error("Mint failed:",s),e({mintError:"Mint failed. Please try again."})}finally{e({isMinting:!1})}}}));var k=a(53999),C=a(18595),M=a(89090),E=a(88579);function F(e){let{isOpen:s,onClose:a,mintData:u}=e,[g,f]=(0,t.useState)("confirm"),{address:p}=(0,m.F)(),{isMinting:b,mintError:N,mintTxHash:y,zapAndMint:j}=A(),{allowance:v,isApproving:w,approveError:F,approveTxHash:S,fetchAllowance:T,approve:R}=(0,C.r)();if(!u)return null;let $=Number.parseFloat(u.amount||"0"),H=Number.parseFloat(u.dreAmount||"0"),z=(0,M.X)(u.amount,18);(0,t.useEffect)(()=>{s&&p&&"0x0000000000000000000000000000000000000000"!==u.tokenAddress&&T(u.tokenAddress,h.A.coreAddresses.uiHelper)},[s,p,T]);let I=async()=>{if(!p){f("error");return}"0x0000000000000000000000000000000000000000"===u.tokenAddress?await _():!v||v<z?await Z():await _()},Z=async()=>{f("approve"),await R(u.tokenAddress,h.A.coreAddresses.uiHelper,E.Ao.toString()),F?f("error"):S&&(f("mint"),await _())},_=async()=>{if(!p){f("error");return}f("mint"),await j(u.amount,p,u.tokenAddress),N?f("error"):y&&f("success")},O=()=>{f("confirm"),a()},B=()=>{switch(g){case"confirm":case"error":default:return 0;case"approve":return 25;case"mint":return 50;case"success":return 100}};return(0,r.jsx)(i.lG,{open:s,onOpenChange:O,children:(0,r.jsxs)(i.Cf,{className:"sm:max-w-md bg-gray-100 border-gray-700",children:[(0,r.jsxs)(i.c7,{children:[(0,r.jsx)(i.L3,{className:"flex items-center gap-2 text-gray-700",children:"Mint RZR"}),(0,r.jsx)(i.rr,{className:"text-gray-400",children:"Automatically convert your assets into RZR"})]}),(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,r.jsx)("span",{className:"text-gray-600",children:"Transaction Progress"}),(0,r.jsxs)("span",{className:"text-gold-400",children:[B(),"%"]})]}),(0,r.jsx)(c.k,{value:B(),className:"h-2 bg-gray-300",indicatorClassName:"bg-gradient-to-r from-gold-500 to-gold-600"})]}),(0,r.jsxs)("div",{className:"rounded-md bg-white border border-gray-300 p-4 space-y-3",children:[(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{className:"text-sm text-gray-400",children:"Your Assets"}),(0,r.jsxs)("span",{className:"text-sm font-mono text-gray-700",children:[(0,k.ej)($)," ",(e=>{let s=Object.entries(h.A.tokens).find(s=>{let[a,r]=s;return r.address===e});return s?s[1].symbol:"SONIC"})(u.tokenAddress)]})]}),(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{className:"text-sm text-gray-400",children:"RZR to Receive"}),(0,r.jsxs)("span",{className:"text-sm font-mono text-gold-400",children:[(0,k.ej)(H)," RZR"]})]})]}),"success"===g&&(0,r.jsxs)(d.Fc,{className:"bg-green-500/10 border-green-500/30",children:[(0,r.jsx)(n.A,{className:"h-4 w-4 text-green-400"}),(0,r.jsxs)(d.TN,{className:"text-gray-300",children:[(0,r.jsx)("strong",{children:"Success!"})," ",(0,k.ej)(H)," RZR minted.",(0,r.jsx)("div",{className:"mt-2 space-y-1",children:(0,r.jsx)("div",{className:"text-xs font-mono text-green-400",children:(0,r.jsx)(x(),{href:"https://sonicscan.org/tx/".concat(y),target:"_blank",className:"text-green-400",children:"View Transaction on Explorer"})})})]})]}),"error"===g&&(0,r.jsx)(d.Fc,{className:"bg-red-500/10 border-red-500/30",children:(0,r.jsxs)(d.TN,{className:"text-gray-800",children:[(0,r.jsx)("strong",{children:"Error:"})," ",N||F||"Transaction failed"]})}),(0,r.jsxs)("div",{className:"space-y-3",children:["confirm"===g&&(0,r.jsx)("div",{className:"space-y-4",children:(0,r.jsxs)("div",{className:"flex gap-3",children:[(0,r.jsx)(o.$,{variant:"outline",className:"flex-1 text-gray-600 border-gray-500",onClick:O,children:"Cancel"}),(0,r.jsx)(o.$,{className:"flex-1 bg-gradient-to-r from-blue-primary text-white to-yellow-primary",onClick:I,children:"Mint"})]})}),"approve"===g&&(0,r.jsx)("div",{className:"space-y-4",children:(0,r.jsx)(o.$,{className:"w-full bg-gradient-to-r text-white",disabled:w,onClick:Z,children:w?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(l.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Approving..."]}):"Approve"})}),"mint"===g&&(0,r.jsx)("div",{className:"space-y-4",children:(0,r.jsx)(o.$,{className:"w-full bg-gradient-to-r from-gold-500 to-gold-600 hover:from-gold-600 hover:to-gold-700 text-white",disabled:b,onClick:_,children:b?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(l.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Minting..."]}):"Execute Mint"})}),"success"===g&&(0,r.jsx)("div",{className:"space-y-4",children:(0,r.jsx)(o.$,{className:"w-full bg-gradient-to-r from-gold-500 to-gold-600 hover:from-gold-600 hover:to-gold-700 text-black",onClick:O,children:"Close"})}),"error"===g&&(0,r.jsx)("div",{className:"space-y-4",children:(0,r.jsx)(o.$,{variant:"outline",className:"w-full text-gray-600",onClick:()=>f("confirm"),children:"Try Again"})})]})]})]})})}},89852:(e,s,a)=>{a.d(s,{p:()=>l});var r=a(95155),t=a(12115),n=a(53999);let l=t.forwardRef((e,s)=>{let{className:a,type:t,...l}=e;return(0,r.jsx)("input",{type:t,className:(0,n.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:s,...l})});l.displayName="Input"}}]);